# MatrixLib AI Generation Prompt

This document contains the prompt that can be used to regenerate this library from scratch using GitHub Copilot with Claude Sonnet 4.5 or similar AI coding assistants.

## Regeneration Prompt

```
Create a production-ready, header-only C++11 linear algebra library for embedded systems called "MatrixLib" with the following specifications:

CORE CLASSES (all in matrixlib namespace):
- Vec<T,N>: N-dimensional vector with component access, arithmetic operations (add/sub/mul/div), 
  dot/cross products, normalization, projection, rotation, lerp
- Mat<T,R,C>: R×C matrix with row-major storage, matrix multiplication, transpose, Frobenius norm
- SquareMat<T,N>: extends Mat with determinant, inverse, rotation matrices (x/y/z axis, axis-angle, 
  from-to, look-at), scale, translation, Euler angles
- Quaternion<T>: 4-component [x,y,z,w] with axis-angle construction, rotate vector, conjugate, 
  norm, inverse, to_matrix, lerp, slerp

REQUIREMENTS:
- Header-only implementation (no .cpp files)
- Trivially copyable types (std::is_trivially_copyable) with alignas(16) for all data arrays
- Zero dynamic allocation (stack only)
- Full const correctness
- Compile-time dimension checking
- Component indices: X=0, Y=1, Z=2, W=3
- Named accessors: x(), y(), z(), w() where applicable
- Quaternion memory layout: [x,y,z,w] for Vec<T,3> integration
- Sanitizer-clean: No undefined behavior, passes ASan/UBSan/MSan
- Type-punning safety: Use MATRIX_BIT_CAST (std::bit_cast in C++20, memcpy in C++11)

SIMD OPTIMIZATIONS:
- ARM NEON support (CONFIG_MATRIXLIB_NEON): optimize Vec<float,2/3/4> and Quaternion<float>
  operations (add, subtract, multiply, dot) using vld1q_f32, vaddq_f32, vsubq_f32, vmulq_f32, 
  vpadd_f32, vnegq_f32 for ARM Cortex-A, ARM64, and Apple Silicon
- CMSIS-DSP support (CONFIG_MATRIXLIB_CMSIS): use arm_add_f32, arm_sub_f32, arm_dot_prod_f32,
  arm_mat_mult_f32, arm_quaternion_product_f32 for float types on ARM Cortex-M
- Three-tier optimization: NEON → CMSIS → Generic C++

C++ STANDARD OPTIMIZATIONS:
- C++11 baseline (100% compatible, required minimum)
- C++14 features: MATRIX_CONSTEXPR14 (relaxed constexpr for compile-time computation)
- C++17 features: MATRIX_IF_CONSTEXPR (compile-time branching), MATRIX_INLINE_VAR, MATRIX_CONSTEXPR17
- C++20 features: MATRIX_CONSTEXPR20, MATRIX_CONSTEVAL, MATRIX_CONSTINIT, MATRIX_LIKELY/UNLIKELY 
  (branch hints), MATRIX_BIT_CAST (safe type conversion), concepts (Arithmetic, FloatingPoint, Integral)
- C++23 features: MATRIX_CONSTEXPR23, MATRIX_IF_CONSTEVAL
- C++26 features: MATRIX_CONSTEXPR26, MATRIX_CONSTEXPR_TRIG (constexpr sin/cos/sqrt enabling 
  compile-time rotation matrices with arbitrary angles)
- Compile-time rotations: Special angles (0°/90°/180°/270°) for C++11-C++23 using rotation_x_deg<>(),
  arbitrary angles in C++26 using constexpr trigonometry
- Feature detection macros automatically enable optimizations based on __cplusplus
- Performance: 10-20% improvement with C++20, additional 5-15% with C++26 for rotation-heavy code

VERSION API (include/matrixlib/version.hpp):
- Version 1.0.0
- Macros: MATRIXLIB_VERSION_MAJOR/MINOR/PATCH/STRING/NUMBER
- Functions: get_version_string(), get_version_number(), version_at_least(major, minor, patch)
- Struct: matrixlib::Version with static constexpr members

BUILD SYSTEM:
- CMake 3.13.1+ with options: MATRIXLIB_ENABLE_NEON, MATRIXLIB_ENABLE_CMSIS
- Zephyr RTOS module with Kconfig options: CONFIG_MATRIXLIB_NEON, CONFIG_MATRIXLIB_CMSIS
- IAR Embedded Workbench for ARM support (compiler detection, C++11 flags, FPU configuration)
- Git submodule and CMake FetchContent support
- Supported compilers: GCC, Clang, MSVC, ARM Compiler 6, IAR EWARM

DOCUMENTATION:
- Doxygen C++ style (///) headers on all files with @file, @brief, @details, @copyright, 
  @author, @date
- SPDX-License-Identifier: MIT on all source files
- Copyright (c) 2026 James Baldwin
- Comprehensive README.md with features, examples, SIMD optimization guide, AI attribution
- API_Documentation.md with complete class reference and usage patterns
- QUICKSTART.md with integration methods (Git, CMake FetchContent, Zephyr, IAR) and first program
- IAR_Integration.md with comprehensive IAR Embedded Workbench setup guide (CMSIS/NEON/generic configs)
- Cpp_Standard_Optimizations.md documenting C++14/17/20/23/26 features and performance benefits
- Sanitizer_Safety.md documenting UB prevention, type-punning safety, and sanitizer testing

TESTING:
- Google Test suite (tests/google/) with test_vec.cpp, test_mat.cpp, test_quat.cpp, test_constants.cpp, test_edge_cases.cpp
- Zephyr ztest suite (tests/zephyr/src/) with equivalent tests including test_constants.cpp
- Edge case tests for singular matrices, NaN/Inf handling, quaternion aliasing safety, SIMD alignment
- Example program (examples/basic_usage.cpp) demonstrating all major features
- All tests use quaternion.hpp (not quat.hpp)
- Sanitizer testing instructions for UBSan, ASan, MSan in Sanitizer_Safety.md

QUALITY:
- All classes must be trivially copyable (std::is_trivially_copyable, not deprecated std::is_pod)
- No virtual functions or inheritance (except SquareMat extends Mat)
- 16-byte alignment for SIMD efficiency
- Include guards and #pragma once
- Static assertions for trivially copyable types
- Operator overloading for intuitive syntax
- Both member and free function forms where appropriate
- MATRIX_BIT_CAST macro for safe type conversion (std::bit_cast in C++20, memcpy fallback in C++11)
- Quaternion vec() accessor returns by value (not reference) to avoid type-punning UB
- Zero undefined behavior: no strict aliasing violations, no invalid pointer casts

FILE STRUCTURE:
include/matrixlib/{matrixlib.hpp, vector.hpp, vec2D.hpp, vec3D.hpp, matrix.hpp, matrix2D.hpp, 
  matrix3D.hpp, quaternion.hpp, constants.hpp, version.hpp}
examples/{basic_usage.cpp, constexpr_rotations.cpp, CMakeLists.txt}
tests/{google/, zephyr/}
zephyr/{module.yml, Kconfig, CMakeLists.txt, README.md}
docs/{API_Documentation.md, IAR_Integration.md, Cpp_Standard_Optimizations.md, Sanitizer_Safety.md}
{README.md, QUICKSTART.md, LICENSE, VERSION, CMakeLists.txt, SAFETY_IMPROVEMENTS.md}
{.editorconfig, .gitattributes, .clang-format, .clang-tidy}

MODULAR HEADER STRUCTURE:
- matrixlib.hpp: Main convenience header including all components
- constants.hpp: Mathematical constants (pi, e, sqrt2, etc.) - can be used standalone
- vector.hpp: Generic Vec<T,N> template with all vector operations
- vec2D.hpp: 2D vector type aliases (Vec2f, Vec2d, Vec2i, Vec2u)
- vec3D.hpp: 3D vector type aliases (Vec3f, Vec3d, Vec3i, Vec3u)
- matrix.hpp: Generic Mat<T,R,C> and SquareMat<T,N> templates
- matrix2D.hpp: 2D transformation matrices (rotation, scale)
- matrix3D.hpp: 3D/4D transformation matrices (rotations, look-at, translation)
- quaternion.hpp: Quaternion rotations with SIMD optimization
- version.hpp: Runtime version API

CODE QUALITY TOOLS:
- .editorconfig: UTF-8, LF line endings, 4-space indent for C++, 2-space for Markdown/YAML
- .gitattributes: Auto text detection with LF normalization, C++ diff strategy, Linguist overrides
- .clang-format: Allman brace style, 4-space indent, 120 column limit, C++11 standard
- .clang-tidy: Comprehensive checks (bugprone, cert, clang-analyzer, cppcoreguidelines, performance, 
  readability) with embedded-friendly exclusions

Generate all files with production-quality code, comprehensive documentation, and full SIMD 
optimization support for embedded ARM platforms.
```

## Usage

To regenerate this library:

1. Start a new GitHub Copilot chat session with Claude Sonnet 4.5
2. Paste the regeneration prompt above
3. The AI will generate all files with equivalent functionality
4. Review and test the generated code
5. Adjust as needed for your specific requirements

## Notes

- The original library was created through iterative development with multiple refinement steps
- This prompt captures the final state after optimizations and enhancements
- Some implementation details may vary, but core functionality should be equivalent
- Consider adding additional test cases or platform-specific optimizations as needed
- Generated using GitHub Copilot with Claude Sonnet 4.5 model

## Generation Metadata

- AI Model: GitHub Copilot with Claude Sonnet 4.5
- Generation Date: January 26, 2026
- Library Version: 1.0.0
- C++ Standard: C++11 baseline with C++14/17/20/23/26 optimizations
- Last Updated: January 26, 2026 (added sanitizer safety improvements)

- **AI Model**: Claude Sonnet 4.5 (via GitHub Copilot)
- **Generated**: January 25, 2026
- **Updated**: January 26, 2026 (UB elimination, modular headers, constants.hpp)
- **Library Version**: 1.0.0
- **License**: MIT

---

*This prompt is maintained as part of the MatrixLib repository to enable reproducibility 
and serve as a reference for AI-assisted development workflows.*
